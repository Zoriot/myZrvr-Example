name: Deploy Infrastructure - Development

on:
  push:
    branches: [ "dev" ]
jobs:
  build-terra:
    uses: Zoriot/Zrvr/.github/workflows/build-template.yml@dev
    with:
      service: Terra
      environment: dev
    permissions:
      contents: read
      packages: write
      id-token: write
  deploy:
    uses: Zoriot/Zrvr/.github/workflows/deploy-template.yml@dev
    with:
      ssh-host: ${{ secrets.SSH_HOST }}
      ssh-user: ${{ secrets.SSH_USER }}
      ssh-key: ${{ secrets.SSH_KEY }}
      compose-file: docker-compose-dev.yml
      environment: dev